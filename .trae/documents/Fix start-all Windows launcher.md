## التشخيص
- رسالة الخطأ اللي عندك (cd بدون quotes + DATABASE_URL بدون quotes + EADDRINUSE) معناها إن اللي بيتنفّذ عندك غالبًا **نسخة قديمة** من start-all (اللي كان بيشغّل أوامر بـ -Command وفيها cd ومسارات بدون quoting).
- النسخة الحالية في المشروع عندي تستخدم Start-Process مع WorkingDirectory + EncodedCommand وده لا يُنتج الأخطاء دي، فالأولوية: نثبت 100% أي ملف بيتنفّذ عندك وإيه اللي بيحصل جوه.

## التعديلات المقترحة (بدون تغييرات في منطق المشروع)
1) **إضافة Logging واضح**
- تعديل start-all.ps1 ليكتب ملف log مثل `start-all.log` فيه:
  - مسار السكربت اللي اتشغّل فعلاً
  - `$root` و`$webDir`
  - البورت المختار فعلاً
  - `NEXT_PUBLIC_API_BASE_URL`
  - PIDs للـ backend والـ frontend
  - أي Exception بشكل كامل

2) **تعديل start-all.cmd ليمنع “الشاشة بتقفل” ويظهر الأخطاء**
- تشغيل PowerShell بـ `-NoExit` أثناء التشخيص.
- طباعة مسار الملف اللي بيتنفّذ (للتأكد إنك بتشغل نفس النسخة داخل system).
- `pause` دائمًا بعد التنفيذ في وضع debug.

3) **إضافة ملف تشغيل Debug منفصل**
- إضافة `start-all-debug.cmd` يفتح نافذة واحدة فقط ويشغل السكربت ويعرض اللوج، علشان نعرف السبب لو في سياسة PowerShell/صلاحيات/مسار.

4) **حل EADDRINUSE بشكل محسّن**
- لو 4000 مستخدم: السكربت يختار بورت بديل ويطبع رسالة كبيرة بالـ port النهائي.
- ويضبط `NEXT_PUBLIC_API_BASE_URL` للفرونت بنفس البورت تلقائيًا.

5) **إضافة stop-all.cmd (اختياري لكن مفيد)**
- يقرأ PIDs من اللوج ويقفل الـ backend/ frontend بسهولة قبل إعادة التشغيل.

## التحقق بعد التعديل
- تشغيل `start-all-debug.cmd` للتأكد أن:
  - لا يوجد خطأ cd/doctor نهائيًا
  - اللوج يظهر المسارات والبورت
  - يتم فتح نافذتين وتظهر رسائل next dev و ts-node-dev

لو موافق، هنفّذ التعديلات دي على الملفات: `start-all.ps1`, `start-all.cmd` + إضافة `start-all-debug.cmd` (و `stop-all.cmd` لو تحب).